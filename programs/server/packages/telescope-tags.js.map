{"version":3,"sources":["telescope-tags/lib/categories.js","telescope-tags/lib/custom_fields.js","telescope-tags/lib/hooks.js","telescope-tags//home/action/workspace/Telescope/packages/telescope-tags/package-tap.i18n","telescope-tags/lib/server/publications.js","telescope-tags//home/action/workspace/Telescope/packages/telescope-tags/i18n/de.i18n.json","telescope-tags//home/action/workspace/Telescope/packages/telescope-tags/i18n/en.i18n.json","telescope-tags//home/action/workspace/Telescope/packages/telescope-tags/i18n/es.i18n.json","telescope-tags//home/action/workspace/Telescope/packages/telescope-tags/i18n/fr.i18n.json","telescope-tags//home/action/workspace/Telescope/packages/telescope-tags/i18n/it.i18n.json","telescope-tags//home/action/workspace/Telescope/packages/telescope-tags/i18n/zh-CN.i18n.json"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,kB;AACA,mC;AACA,S;AACA,gB;AACA,I;AACA,gB;AACA,iB;AACA,mB;AACA,e;AACA,a;AACA,K;AACA,I;AACA,U;AACA,iB;AACA,kB;AACA,I;AACA,S;AACA,iB;AACA,mB;AACA,e;AACA,K;AACA,G;AACA,G;;AAEA,iD;AACA,wC;;AAEA,iD;AACA,+C;AACA,gB;AACA,iC;AACA,G;;AAEA,gC;AACA,4C;AACA,kE;AACA,U;AACA,+C;AACA,kG;AACA,I;AACA,C;;AAEA,4B;AACA,oB;AACA,wB;AACA,wB;AACA,uB;AACA,K;;AAEA,kB;AACA,uC;AACA,2B;AACA,oD;AACA,kG;AACA,iD;AACA,2B;AACA,K;AACA,K;AACA,G;;AAEA,qC;AACA,yF;AACA,C;;AAEA,gC;AACA,uC;AACA,E;;AAEA,gD;AACA,mD;AACA,yG;AACA,gD;AACA,G;;;;;;;;;;;;;;;;;;ACxEA,qB;AACA,G;AACA,+B;AACA,qB;AACA,qB;AACA,qB;AACA,qB;AACA,iB;AACA,uB;AACA,uB;AACA,8B;AACA,sE;AACA,oB;AACA,kC;AACA,kC;AACA,e;AACA,a;AACA,4B;AACA,S;AACA,O;AACA,K;AACA,G;AACA,E;;;;;;;;;;;;;;;;;;ACtBA,gB;AACA,sB;AACA,sB;AACA,0C;AACA,G;;AAEA,2C;AACA,kB;AACA,6B;AACA,W;AACA,G;AACA,E;AACA,+C;AACA,iB;AACA,6B;AACA,W;AACA,G;;AAEA,8E;AACA,wC;;;;;;;;;;;;;;;;;;;ACnBA,gH;;AAEA,+D;AACA,gD;;;;;;;;;;;;;;;;;;;ACHA,yC;AACA,gC;AACA,6B;AACA,G;AACA,Y;AACA,G;;;;;;;;;;;;;;;;;;ACLA,6B;AACA,oC;AACA,iC;;AAEA,gC;AACA,yD;AACA,C;AACA,+C;AACA,kC;AACA,C;;AAEA,0D;AACA,6C;AACA,C;;AAEA,6E;;;;;;;;;;;;;;;;;;;ACfA,6B;AACA,oC;AACA,iC;;AAEA,gC;AACA,yD;AACA,C;AACA,gD;AACA,iI;;;;;;;;;;;;;;;;;;;ACRA,6B;AACA,oC;AACA,iC;;AAEA,gC;AACA,yD;AACA,C;AACA,+C;AACA,kC;AACA,C;;AAEA,0D;AACA,6C;AACA,C;;AAEA,6E;;;;;;;;;;;;;;;;;;;ACfA,6B;AACA,oC;AACA,iC;;AAEA,gC;AACA,yD;AACA,C;AACA,+C;AACA,kC;AACA,C;;AAEA,0D;AACA,6C;AACA,C;;AAEA,6E;;;;;;;;;;;;;;;;;;;ACfA,6B;AACA,oC;AACA,iC;;AAEA,gC;AACA,yD;AACA,C;AACA,+C;AACA,kC;AACA,C;;AAEA,0D;AACA,6C;AACA,C;;AAEA,4E;;;;;;;;;;;;;;;;;;;ACfA,6B;AACA,oC;AACA,iC;;AAEA,gC;AACA,yD;AACA,C;AACA,kD;AACA,qC;AACA,C;;AAEA,6D;AACA,gD;AACA,C;;AAEA,wE","file":"/packages/telescope-tags.js","sourcesContent":["// category schema\ncategorySchema = new SimpleSchema({\n  name: {\n    type: String\n  },\n  description: {\n    type: String,\n    optional: true,\n    autoform: {\n      rows: 3\n    }\n  },\n  order: {\n    type: Number,\n    optional: true\n  },\n  slug: {\n    type: String,\n    optional: true,\n    autoform: {\n    }\n  }\n});\n\nCategories = new Meteor.Collection(\"categories\");\nCategories.attachSchema(categorySchema);\n\nCategories.before.insert(function (userId, doc) {\n  // if no slug has been provided, generate one\n  if (!doc.slug)\n    doc.slug = slugify(doc.name);\n});\n\n// category post list parameters\nviewParameters.category = function (terms) {\n  var categoryId = Categories.findOne({slug: terms.category})._id;\n  return {\n    find: {'categories': {$in: [categoryId]}} ,\n    options: {sort: {sticky: -1, score: -1}} // for now categories views default to the \"top\" view\n  };\n}\n\nMeteor.startup(function () {\n  Categories.allow({\n    insert: isAdminById,\n    update: isAdminById,\n    remove: isAdminById\n  });\n\n  Meteor.methods({\n    submitCategory: function(category){\n      console.log(category)\n      if (!Meteor.user() || !isAdmin(Meteor.user()))\n        throw new Meteor.Error(i18n.t('you_need_to_login_and_be_an_admin_to_add_a_new_category'));\n      var categoryId=Categories.insert(category);\n      return category.name;\n    }\n  });\n});\n\ngetPostCategories = function (post) {\n  return !!post.categories ? Categories.find({_id: {$in: post.categories}}).fetch() : [];\n}\n\ngetCategoryUrl = function(slug){\n  return getSiteUrl()+'category/'+slug;\n};\n\n// add callback that adds categories CSS classes\npostClassCallbacks.push(function (post, postClass){\n  var classArray = _.map(getPostCategories(post), function (category){return \"category-\"+category.slug});\n  return postClass + \" \" + classArray.join(' ');\n});","addToPostSchema.push(\n  {\n    propertyName: 'categories',\n    propertySchema: {\n      type: [String],\n      optional: true,\n      editable: true,\n      autoform: {\n        editable: true,\n        noselect: true,\n        options: function () {\n          var categories = Categories.find().map(function (category) {\n            return {\n              value: category._id,\n              label: category.name\n            }  \n          });\n          return categories;\n        }\n      }\n    }\n  }\n);","adminMenu.push({\n  route: 'categories',\n  label: 'Categories',\n  description: 'add_and_remove_categories'\n});\n\n// push \"categories\" modules to postHeading\npostHeading.push({\n  template: 'postCategories',\n  order: 30\n});\n  \n// push \"categoriesMenu\" template to primaryNav\nprimaryNav.push({\n  template: 'categoriesMenu',\n  order: 50\n});\n\n// we want to wait until categories are all loaded to load the rest of the app\npreloadSubscriptions.push('categories');\n","TAPi18n.packages[\"telescope-tags\"] = {\"translation_function_name\":\"__\",\"helper_name\":\"_\",\"namespace\":\"project\"};\n\n// define package's translation function (proxy to the i18next)\n__ = TAPi18n._getPackageI18nextProxy(\"project\");\n","Meteor.publish('categories', function() {\n  if(can.viewById(this.userId)){\n    return Categories.find();\n  }\n  return [];\n});","var _ = Package.underscore._,\n    package_name = \"telescope-tags\",\n    namespace = \"telescope-tags\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\nif(_.isUndefined(TAPi18n.translations[\"de\"])) {\n  TAPi18n.translations[\"de\"] = {};\n}\n\nif(_.isUndefined(TAPi18n.translations[\"de\"][namespace])) {\n  TAPi18n.translations[\"de\"][namespace] = {};\n}\n\n_.extend(TAPi18n.translations[\"de\"][namespace], {\"categories\":\"Kategorien\"});\n","var _ = Package.underscore._,\n    package_name = \"telescope-tags\",\n    namespace = \"telescope-tags\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\n// integrate the fallback language translations \nTAPi18n.addResourceBundle(\"en\", namespace, {\"categories\":\"Categories\",\"add_and_remove_categories\":\"Add and remove categories.\"});\n","var _ = Package.underscore._,\n    package_name = \"telescope-tags\",\n    namespace = \"telescope-tags\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\nif(_.isUndefined(TAPi18n.translations[\"es\"])) {\n  TAPi18n.translations[\"es\"] = {};\n}\n\nif(_.isUndefined(TAPi18n.translations[\"es\"][namespace])) {\n  TAPi18n.translations[\"es\"][namespace] = {};\n}\n\n_.extend(TAPi18n.translations[\"es\"][namespace], {\"categories\":\"Categorías\"});\n","var _ = Package.underscore._,\n    package_name = \"telescope-tags\",\n    namespace = \"telescope-tags\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\nif(_.isUndefined(TAPi18n.translations[\"fr\"])) {\n  TAPi18n.translations[\"fr\"] = {};\n}\n\nif(_.isUndefined(TAPi18n.translations[\"fr\"][namespace])) {\n  TAPi18n.translations[\"fr\"][namespace] = {};\n}\n\n_.extend(TAPi18n.translations[\"fr\"][namespace], {\"categories\":\"Catégories\"});\n","var _ = Package.underscore._,\n    package_name = \"telescope-tags\",\n    namespace = \"telescope-tags\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\nif(_.isUndefined(TAPi18n.translations[\"it\"])) {\n  TAPi18n.translations[\"it\"] = {};\n}\n\nif(_.isUndefined(TAPi18n.translations[\"it\"][namespace])) {\n  TAPi18n.translations[\"it\"][namespace] = {};\n}\n\n_.extend(TAPi18n.translations[\"it\"][namespace], {\"categories\":\"Categorie\"});\n","var _ = Package.underscore._,\n    package_name = \"telescope-tags\",\n    namespace = \"telescope-tags\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\nif(_.isUndefined(TAPi18n.translations[\"zh-CN\"])) {\n  TAPi18n.translations[\"zh-CN\"] = {};\n}\n\nif(_.isUndefined(TAPi18n.translations[\"zh-CN\"][namespace])) {\n  TAPi18n.translations[\"zh-CN\"][namespace] = {};\n}\n\n_.extend(TAPi18n.translations[\"zh-CN\"][namespace], {\"categories\":\"分类\"});\n"]}